Project Plan: Refactorización Atómica de Caché (Access VBA)Este documento define la hoja de ruta para optimizar la persistencia de datos del árbol de Ediciones, Riesgos y Planes, pasando de una actualización global a una actualización atómica por entidad.1. Fase de Análisis y DescubrimientoEl objetivo es mapear el flujo actual de datos sin realizar cambios.Identificación del Generador de Caché: Localizar el módulo/procedimiento encargado de poblar la tabla de caché (ej. GenerarCacheArbol, RefrescarTodo).Mapeo de Entidades (CRUD): Identificar en qué partes de los archivos .cls y .bas se realizan operaciones de inserción, actualización o borrado en:Ediciones ($N$ por proyecto).Riesgos.Planes (Mitigación/Contingencia).Acciones.Análisis de Estructura de Datos: Evaluar la clave primaria y las relaciones en la tabla de caché para determinar cómo identificar de forma unívoca el "nodo" a actualizar.2. Definición de la Estrategia de Actualización AtómicaPUNTO DE CONTROL: El CLI presentará un resumen de los puntos críticos detectados y esperará tu confirmación (YES/NO) para proceder.Diseño de Micro-Actualizaciones: En lugar de invalidar toda la caché, se crearán (o modificarán) métodos que actualicen únicamente el registro afectado en la tabla de caché tras un evento AfterUpdate o similar.Lógica de Sincronización: Asegurar que si un Riesgo cambia, solo su rama en la caché se vea afectada, manteniendo la integridad del árbol.3. Implementación de CambiosUna vez autorizado, Codex CLI procederá a:Modificación de Módulos de Clase (.cls): Inyectar o modificar la lógica en los métodos de persistencia de cada objeto (Edición, Riesgo, etc.) para llamar al actualizador de caché.Ajustes en Módulos Estándar (.bas): Refactorizar funciones globales de gestión de datos que afecten a la estructura del árbol.Optimización del Procedimiento de Carga: Asegurar que el formulario del árbol lea de forma eficiente los cambios realizados atómicamente.4. Entregable Final: Informe de Integración ManualEste es el componente más importante para tu flujo de trabajo. El CLI generará un archivo llamado CHANGELOG_INTEGRATION.md con el siguiente formato:Módulo / ArchivoMétodo / FunciónCambio RealizadoDescripción del AjusteclsRiesgo.clsGuardar()Inserción de códigoLlamada a ActualizarNodoCache tras el Update.modCache.basUpdateAtomic()Nueva FunciónLógica para hacer el SQL Update solo de una fila.frmArbol.clscmdGuardar_ClickModificaciónAdaptación para no refrescar el árbol completo.Instrucciones para Codex CLINo sobrescribas los archivos originales sin antes haber listado las funciones detectadas que requieren intervención.Prioriza la idempotencia: Asegúrate de que las funciones de actualización atómica comprueben si el registro existe en la caché antes de intentar actualizarlo.Generación del Reporte: Al finalizar, el resumen de cambios debe ser exhaustivo para facilitar el "Copy-Paste" al entorno real de Access.